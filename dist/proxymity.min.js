var proxymity=function(e){function n(e){return Array.prototype.slice.call(e||[])}function t(e,n){return e&&i(e.length)&&Array.prototype.forEach.call(e,n)}function r(e){return"function"==typeof e}function o(e){return"string"==typeof e}function i(e){return"number"==typeof e&&!isNaN(e)}function a(e){return"object"==typeof e}function c(e){return Object.getOwnPropertyNames(e)}function u(e,n){var t,r,o;return void 0===n||e>n?(r=e,t=n||0):(t=e,r=n),o=r-t,Math.round(Math.random()*(o+.9998)-.4999)+t}var f="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_";function s(e=16){for(var n=f[u(51)],t=1;t<e;t++)n+=f[u(62)];return n}function l(e,n){var r=c(n);for(var o in e)n[o]=e[o],r.splice(r.indexOf(o),1);t(r,function(e,t){e||"length"===t||delete n[t]}.bind(null,Array.isArray(n)))}function d(e,n,t){return Object.defineProperty(e,n,{value:t}),t}function p(e,n,t,r){return defineConfigs={get:t},r&&(defineConfigs.set=r),Object.defineProperty(e,n,defineConfigs)}function h(e){return e.trim()[0].match(/[\w\_\$]/)?".":""}var v=function(){var e=s(u(32,48)),n=!1,r=[];function o(t){var o=Array.prototype.slice.call(arguments,1);n||(window.postMessage(e,"*"),n=!0),t.res=!1,r.push({fn:t,args:o})}return window.addEventListener("message",function(i){if(i.data===e){i.stopPropagation();var a=r;e=s(u(32,48)),n=!1,r=[],t(a,function(e){e.fn.res||(e.fn.apply(window,e.args),e.fn.res=!0)}),o.asyncEnd&&(o.asyncEnd(),delete o.asyncEnd,delete o.asyncEndPromise),!n&&o.renderEnd&&(o.renderEnd(),delete o.renderEnd,delete o.renderEndPromise)}}),o}();function y(e){return e&&Object.getPrototypeOf(e)===Object.prototype?H(e):e&&Object.getPrototypeOf(e)===Array.prototype&&F(e),e}var m=function(){},g=m,b=m,O=function(e){for(var n=this.slice(),t=0;n&&t<n.length;t++)this.indexOf(n[t])>-1&&n[t](e)},w=function(e){var n=this;return n.push(e),function(){n.splice(n.indexOf(e),1)}},E=function(e,n,r=[]){a(e)&&t(c(e),function(t){var o=e[t],i=b;r.indexOf(i)>-1||(v(i,n),r.push(i),E(o,n,r))})};function k(e,n,t,r=!1){if(!e.hasOwnProperty(n)){var o=[],i=w.bind(o),a=O.bind(o);Object.defineProperty(e,n,{enumerable:r,configurable:!0,get:function(){return Array.isArray(t)?(g=S(t,I),b=S(t,T)):(g=i,b=a),t},set:function(r){return r===t?t:(E(t,"remap"),void 0===r?(v(a,"del"),delete e[n]):(v(a,"set"),t=y(r)))}}),y(t),Array.isArray(t)?(g=S(t,I),b=S(t,T),v(S(t,T),"set")):(g=i,b=a,v(a,"set"))}}function A(e,n,t){var o=n[t];return r(n[t])&&(o=function(){if(Array.isArray(this))var e=this.length;var r=n[t].apply(this,Array.from(arguments));return i(e)&&e!==this.length&&Array.isArray(this)&&v(S(this,T),"set"),r}),k(e,t,o,n.propertyIsEnumerable(t))}var P=!1,j=["constructor","toJSON"],N={get:function(e,n,t){if(-1===j.indexOf(n)){if(n in e){for(var r=Object.getPrototypeOf(e),o=t,i=t,a=Object.getPrototypeOf(o);a!==r;)i=o,o=a,a=Object.getPrototypeOf(o);A(i,e,n)}else if(P)return N.set(e,n,{},t),t[n];return Reflect.get(e,n,t)}},set:function(e,n,t,r){var o=Array.isArray(r);if(o)var i=r.length;return k(r,n,t,!0),o&&r.length!==i&&v(S(r,T),"set"),!0}};function C(n,t){var r,o=this;return J(function(){P=!0,r=e.call(o,"this"+h(n)+n),P=!1},function(){P=!0;var i=e.call(o,"this"+h(n)+n);P=!1,i!==r&&(r=i,t(i))})}function x(e){var n={};k(n,"watch",C),k(n,"toString",function(){return S(this,"string")});for(var r=e;r;)t(Object.getOwnPropertyNames(r),A.bind(this,n,r)),r=Object.getPrototypeOf(r);return Object.setPrototypeOf(n,new Proxy(e,N)),n}function L(e){return Object.setPrototypeOf(e,L.prototype),e}function S(e,n){if(r(e[Symbol.toPrimitive])){var t=e[Symbol.toPrimitive](n);if(void 0!==t)return t}return m}L.prototype=Object.create(Function.prototype);var I=s(u(32,48)),T=s(u(32,48));function D(e,n){var r,o,i;return e===B&&(r=[],o=L(w.bind(r)),i=L(O.bind(r))),Object.defineProperty(n,Symbol.toPrimitive,{value:function(n){switch(n){case"number":return c(this).length;case"string":return c(this).length?JSON.stringify(this):"";case I:return e===B&&o;case T:return e===B&&i;default:return!!c(this).length}}}),t(Object.getOwnPropertyNames(n),function(t){var r=n[t],o=n.propertyIsEnumerable(t);e===B&&"length"===t||(delete n[t],k(n,t,r,o))}),Object.setPrototypeOf(n,e)}var B=x(Array.prototype),M=x(Object.prototype),F=D.bind(this,B),H=D.bind(this,M);function J(e,n,o=[]){e();var i=g;if(r(n)){n=[{to:"del",fn:n},{to:"set",fn:n}]}t(n,function(e){o.push(i(e.fn)),e.fn()});var a=function(){t(o,function(e){e()}),o.length=0};return o.push(i(function(t){"remap"!==t&&"del"!==t||(a(),J(e,n,o))})),a}function R(n,r,o){var i=[],a=n.textContent.replace(/\{\:([\s\S]*?)\:\}(\|(\s|\n)*\{[\s\S]*?\}(\s|\n)*\|)?/g,function(e,n,t){return i.push({run:n,on:t&&t.replace(/^\|[\s\n]*\{|\}[\s\n]*\|$/g,"").split(/\}[\s\n]*\,[\s\n]*\{/g)}),"{::}"}).split("{::}");if(i.length){var c=[],u=function(t){n.textContent=a.reduce(function(n,o,a){var c="";return i[a]&&(a===t?(P=!0,c=i[a].cache=e.call(r,i[a].run),P=!1):c=i[a].cache),n+o+c},"")};return t(i,function(n,i){n.on?t(n.on,function(n){c.push(J(function(){P=!0,e.call(r,"this."+o+h(n)+n),P=!1},function(){u(i)}))}):u(i)}),function(){t(c,function(e){e()})}}}var q=Object.create(Array.prototype);function K(e,n){t(e,function(e){n(e),K(e.childNodes,n)})}function U(e){K(e,function(e){e.dispatchEvent(new CustomEvent(X))})}d(q,"appendTo",function(e){if(o(e))return q.appendTo.call(this,document.querySelector(e));var n=e;return t(this,function(e){n.appendChild(e)}),this}),d(q,"detach",function(){return t(this,function(e){var n=e.parentElement;n&&n.removeChild(e)}),this}),d(q,"unlink",function(){return U(this),this});var X=s(u(32,48));function $(r,o,i,a){return J(function(){if(i.watcher)return g=S(i.c,I),b=S(i.c,T),delete i.watcher;var n,t=function(){return t};t.in=function(e){if(n=S(e,I),!hiddenKeys||!n instanceof L)throw new Error("Improper usage of key(string).in(array): in(array) is not provided with a proxified object of the same root evaluating ["+i.n.textContent+"]");i.c=e},t.end=function(){},e.call(i.n,i.n.textContent,{key:t},!0),g=S(i.c,I),b=S(i.c,T)},function(){var e,c,u,f=i.t,s=f.indexOf(i.u),l=f.indexOf(i.n),d=i.u.parentNode,p=(e=f.slice(l+1,s),c=i.key,u=[],t(e,function(e){var n=e[c];u[n]=u[n]||[],u[n].push(e)}),u),h=i.c.length;if(p.length<h){for(var v=document.createDocumentFragment();p.length!==h;){var y=i.i.map(function(e){return e.cloneNode(!0)}),m=function(e,n){a(n),K(n,function(n){Object.defineProperty(n,i.key,{configurable:!0,enumerable:!1,get:function(){return e}})})}.bind(this,p.length);m(y),z(n(y),r,o,m),d&&t(y,function(e){v.appendChild(e)}),i.m&&t(y,function(e){e instanceof HTMLElement&&i.m(e)}),f.splice.apply(f,[s,0].concat(y)),s+=y.length,p.push(y)}d.insertBefore(v,i.u)}else if(p.length>h)for(;p.length!==h;){var g=p.pop();t(g,function(e){f.splice(f.indexOf(e),1),e.parentNode&&e.parentNode.removeChild(e)}),U(g)}})}function _(e){return function(n){n.stopPropagation(),t(e,function(e){e()})}}function z(o,i,a,c){var u,f=function(e){if(u)throw new Error("Improper usage of key(string).in(array): key(string) cannot be nested on the same level");return u={key:e},f};return f.in=function(e){if(!u)throw new Error("Improper usage of key(string).in(array): key(string) not called");if(u.c)throw new Error("Improper usage of key(string).in(array): in(array) called before key");var n=S(e,I);if(!n||!n instanceof L)throw new Error("Improper usage of key(string).in(array): in(array) is not provided with a proxified object of the same root");u.watcher=n,u.c=e,u.i=[]},f.end=function(e){if(!(u&&u.key&&u.i&&u.i.length))throw new Error("Improper usage of key.end([onClone]): key(string).in(array) is not called properly prior to calling key.end([onClone])");u.t=o,u.u=u.i.pop(),r(e)&&(u.m=e);for(var n=u.i,t=o.length-1;t>=0;t--)if(-1!==n.indexOf(o[t])){var f=o[t].parentNode;f&&f.removeChild(o[t]),o.splice(t,1)}var s=u.n=u.u.previousSibling,l=_([$(i,a,u,c),function(){s.removeEventListener(X,l)}]);s.addEventListener(X,l),u=void 0},t(n(o),function(n){if(u&&u.i&&u.i.push(n),n instanceof Comment&&"foreach:"===n.textContent.trim().substr(0,8).toLowerCase()){if(G(n,i,a,c),e.call(n,n.textContent,{key:f}),!(!u||u.key&&u.i))throw new Error("Improper usage of key(string).in(array): in(array) not called in conjunction with key");u&&!u.n&&(u.n=n)}}),t(o,function(e){e[a]!==i&&G(e,i,a,c)}),Object.setPrototypeOf(o,q)}function G(r,o,c,f){var d=[];if(Object.defineProperty(r,c,{configurable:!0,get:function(){return o},set:function(e){return a(e)&&l(e,o),o}}),d.push(function(){delete r[c]}),r instanceof CharacterData){var p=R(r,r,c);p&&d.push(p)}else z(n(r.childNodes),o,c,f);t(r.attributes,function(n){var o=R(n,r,c);if(o&&d.push(o),!("name"!==n.name||"INPUT"!==r.nodeName&"TEXTAREA"!==r.nodeName&"SELECT"!==r.nodeName)){var a=function(){try{P=!0;var t=e.call(r,"this."+c+h(n.value)+n.value,{},!0);P=!1,t!==r.value&&(r.value=t)}catch(e){r.value=null,P=!1}},f="value",l=r.type.toLowerCase();"number"===l||"range"===l?(f="valueAsNumber",a=function(){try{P=!0;var t=e.call(r,"this."+c+h(n.value)+n.value,{},!0);P=!1,i(t)&&t!==r.valueAsNumber?r.valueAsNumber=t:t!==r.valueAsNumber&&(r.value=null)}catch(e){r.value=null,P=!1}}):"checkbox"===l?(f="checked",a=function(){try{P=!0;var t=e.call(r,"this."+c+h(n.value)+n.value,{},!0);P=!1,"boolean"==typeof t&&t!==r.checked?r.checked=t:t!==r.checked&&(r.checked=!1)}catch(e){r.checked=!1,P=!1}}):"radio"===l?a=function(){try{P=!0;var t=e.call(r,"this."+c+h(n.value)+n.value,{},!0);P=!1,r.value!==t||r.checked?r.value!==t&&r.checked&&(r.checked=!1):r.checked=!0}catch(e){r.checked=!1,P=!1}}:"date"!==l&&"month"!==l&&"week"!==l&&"time"!==l&&"datetime-local"!==l||(f="valueAsDate",a=function(){try{P=!0;var t=e.call(r,"this."+c+h(n.value)+n.value,{},!0);P=!1,t instanceof Date&&t.getTime()!==r.valueAsDate.getTime()?r.valueAsDate=t:t instanceof Date||(r.value=null)}catch(e){r.value=null,P=!1}}),d.push(J(function(){P=!0,e.call(r,"this."+c+h(n.value)+n.value),P=!1},[{to:"del",fn:a},{to:"set",fn:a}]));var p=["change","keyup","click"],v=function(t){var o=s(u(32,48));e.call(r,"this."+c+h(n.value)+n.value+" = "+o,{[o]:r[f]})};t(p,function(e){r.addEventListener(e,v)}),d.push(function(){t(p,function(e){r.removeEventListener(e,v)})})}}),d.push(function(){r.removeEventListener(X,v)});var v=_(d);return r.addEventListener(X,v),Object.setPrototypeOf([r],q)}var Q=function(e,t={},r="app"){var i=y(t),c=function e(t,r,i,a=function(){}){if(o(t)){var c=document.createElement("template");return c.innerHTML=t.trim(),e(c.content.childNodes,r,i,a)}return t instanceof NodeList||t instanceof Array&&t.reduce(function(e,n){return e&&n instanceof Node},!0)?z(n(t),r,i,a):t instanceof Node?G(t,r,i,a):void 0}(e,i,r);return Object.defineProperty(c,r,{get:function(){return i},set:function(e){a(e)&&l(e,i)}}),c};d(Q,"convert",y);var V=function(e){var n=e+"Promise";return v[n]?v[n]:v[n]=new Promise(function(e){v.prop=e})},W=function(e,n){var t=e+"Promise";r(n)&&v[t].then(n)};return d(Q,"on",{}),p(Q.on,"asyncEnd",V.bind(this,"asyncEnd"),W.bind(this,"asyncEnd")),p(Q.on,"renderEnd",V.bind(this,"renderEnd"),W.bind(this,"renderEnd")),d(Q,"random",{}),d(Q.random,"number",u),d(Q.random,"string",s),Q}(function(s,sv={},t=!1){try{with(sv)return eval(s)}catch(o3o){if(t)throw o3o;return console.error("failed to evaluate expression ["+s+"]",this,o3o),""}});"undefined"!=typeof module&&(module.exports=proxymity);