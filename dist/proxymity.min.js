var proxymity=function(e){function n(e){return Array.prototype.slice.call(e||[])}function t(e,n){return e&&i(e.length)&&Array.prototype.forEach.call(e,n)}function r(e){return"function"==typeof e}function o(e){return"string"==typeof e}function i(e){return"number"==typeof e&&!isNaN(e)}function a(e){return e&&"object"==typeof e}function u(e){return Object.getOwnPropertyNames(e)}function c(e,n){var t,r,o;return void 0===n||e>n?(r=e,t=n||0):(t=e,r=n),o=r-t,Math.round(Math.random()*(o+.9998)-.4999)+t}var f="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_";function s(e=16){for(var n=f[c(51)],t=1;t<e;t++)n+=f[c(62)];return n}function l(e,n){var r=u(n);for(var o in e)n[o]=e[o],r.splice(r.indexOf(o),1);t(r,function(e,t){e||"length"===t||delete n[t]}.bind(null,Array.isArray(n)))}function d(e,n,t){return Object.defineProperty(e,n,{value:t}),t}function p(e,n,t,r){return defineConfigs={get:t},r&&(defineConfigs.set=r),Object.defineProperty(e,n,defineConfigs)}function h(e){return e.trim()[0].match(/[\w\_\$]/)?".":""}var v=function(){var e=s(c(32,48)),n=!1,r=[];function o(t){var o=Array.prototype.slice.call(arguments,1);n||(window.postMessage(e,"*"),n=!0),t.res=!1;var i="push";t.priority&&(i="unshift"),r[i]({fn:t,args:o})}return window.addEventListener("message",function(i){if(i.data===e){i.stopPropagation();var a=r;e=s(c(32,48)),n=!1,r=[],t(a,function(e){e.fn.res||(e.fn.apply(window,e.args),e.fn.res=!0)}),o.asyncEnd&&(o.asyncEnd(),delete o.asyncEnd,delete o.asyncEndPromise),!n&&o.renderEnd&&(o.renderEnd(),delete o.renderEnd,delete o.renderEndPromise)}}),o}();function y(e){return e&&Object.getPrototypeOf(e)===Object.prototype?H(e):e&&Object.getPrototypeOf(e)===Array.prototype&&F(e),e}var m=function(){},g=m,b=m,O=function(e){for(var n=this.slice(),t=0;n&&t<n.length;t++)this.indexOf(n[t])>-1&&n[t](e)},w=function(e){var n=this;return n.push(e),function(){n.splice(n.indexOf(e),1)}},E=function(e,n,r=[]){a(e)&&t(u(e),function(t){var o=e[t],i=b;r.indexOf(i)>-1||(v(i,n),r.push(i),E(o,n,r))})};function k(e,n,t,r=!1){if(!e.hasOwnProperty(n)){var o=[],i=w.bind(o),a=O.bind(o);Object.defineProperty(e,n,{enumerable:r,configurable:!0,get:function(){return t&&(g=S(t,I))?b=S(t,T):(g=i,b=a),t},set:function(r){return r===t?t:(E(t,"remap"),void 0===r?(v(a,"del"),delete e[n]):(v(a,"set"),t=y(r)))}}),y(t),t&&(g=S(t,I))?(b=S(t,T),v(b,"set")):(g=i,b=a,v(a,"set"))}}function P(e,n,t){var o=n[t];return r(n[t])&&(o=function(){var e=Array.isArray(this);if(e)var r=this.length;var o=n[t].apply(this,Array.from(arguments));return i(r)&&r!==this.length&&e&&v(S(this,T),"set"),o}),k(e,t,o,n.propertyIsEnumerable(t))}var A=!1,j=["constructor","toJSON"],N={get:function(e,n,t){if(-1===j.indexOf(n)){if(n in e){for(var r=Object.getPrototypeOf(e),o=t,i=t,a=Object.getPrototypeOf(o);a!==r;)i=o,o=a,a=Object.getPrototypeOf(o);P(i,e,n)}else if(A)return N.set(e,n,{},t),t[n];return Reflect.get(e,n,t)}},set:function(e,n,t,r){var o=Array.isArray(r);if(o)var i=r.length;return k(r,n,t,!0),o&&r.length!==i&&v(S(r,T),"set"),!0}};function C(n,t){var r,o=this;return J(function(){A=!0,r=e.call(o,"this"+h(n)+n),A=!1},function(){A=!0;var i=e.call(o,"this"+h(n)+n);A=!1,i!==r&&(r=i,t(i))})}function x(e){var n={};k(n,"watch",C),k(n,"toString",function(){return S(this,"string")});for(var r=e;r;)t(Object.getOwnPropertyNames(r),P.bind(this,n,r)),r=Object.getPrototypeOf(r);return Object.setPrototypeOf(n,new Proxy(e,N)),n}function L(e){return Object.setPrototypeOf(e,L.prototype),e}function S(e,n){if(r(e[Symbol.toPrimitive])){var t=e[Symbol.toPrimitive](n);if(void 0!==t)return t}}L.prototype=Object.create(Function.prototype);var I=s(c(32,48)),T=s(c(32,48));function D(e,n){var r,o,i;return e===B&&(r=[],o=L(w.bind(r)),(i=L(O.bind(r))).priority=!0),Object.defineProperty(n,Symbol.toPrimitive,{value:function(n){switch(n){case"number":return u(this).length;case"string":return u(this).length?JSON.stringify(this):"";case I:return e===B&&o;case T:return e===B&&i;default:return!!u(this).length}}}),t(Object.getOwnPropertyNames(n),function(t){var r=n[t],o=n.propertyIsEnumerable(t);e===B&&"length"===t||(delete n[t],k(n,t,r,o))}),Object.setPrototypeOf(n,e)}var B=x(Array.prototype),M=x(Object.prototype),F=D.bind(this,B),H=D.bind(this,M);function J(e,n,o=[]){e();var i=g;if(r(n)){n=[{to:"del",fn:n},{to:"set",fn:n}]}t(n,function(e){o.push(i(e.fn)),e.fn()});var a=function(){t(o,function(e){e()}),o.length=0};return o.push(i(function(t){"remap"!==t&&"del"!==t||(a(),J(e,n,o))})),a}function R(n,r,o){var i=[],a=n.textContent.replace(/\{\:([\s\S]*?)\:\}(\|(\s|\n)*\{[\s\S]*?\}(\s|\n)*\|)?/g,function(e,n,t){return i.push({run:n,on:t&&t.replace(/^\|[\s\n]*\{|\}[\s\n]*\|$/g,"").split(/\}[\s\n]*\,[\s\n]*\{/g)}),"{::}"}).split("{::}");if(i.length){var u=[],c=function(t){n.textContent=a.reduce(function(n,o,a){var u="";return i[a]&&(a===t?(A=!0,u=i[a].cache=e.call(r,i[a].run),A=!1):u=i[a].cache),n+o+u},"")};return t(i,function(n,i){n.on?t(n.on,function(n){u.push(J(function(){A=!0,e.call(r,"this."+o+h(n)+n),A=!1},function(){c(i)}))}):c(i)}),function(){t(u,function(e){e()})}}}var q=Object.create(Array.prototype);function U(e,n){t(e,function(e){n(e),U(e.childNodes,n)})}function X(e){U(e,function(e){e.dispatchEvent(new CustomEvent($))})}d(q,"appendTo",function(e){if(o(e))return q.appendTo.call(this,document.querySelector(e));var n=e;return t(this,function(e){n.appendChild(e)}),this}),d(q,"detach",function(){return t(this,function(e){var n=e.parentElement;n&&n.removeChild(e)}),this}),d(q,"unlink",function(){return X(this),this});var $=s(c(32,48));function _(r,o,i,a){return J(function(){if(i.watcher)return g=S(i.c,I),b=S(i.c,T),delete i.watcher;var n,t=function(){return t};t.in=function(e){if(!(n=S(e,I))||!n instanceof L)throw new Error("Improper usage of key(string).in(array): in(array) is not provided with a proxified object of the same root evaluating ["+i.n.textContent+"]");i.c=e},t.end=function(){},e.call(i.n,i.n.textContent,{key:t},!0),g=S(i.c,I),b=S(i.c,T)},function(){var e,u,c,f=i.t,s=f.indexOf(i.u),l=f.indexOf(i.n),d=i.u.parentNode,p=(e=f.slice(l+1,s),u=i.key,c=[],t(e,function(e){var n=e[u];c[n]=c[n]||[],c[n].push(e)}),c),h=i.c.length;if(p.length<h){for(var v=document.createDocumentFragment();p.length!==h;){var y=i.i.map(function(e){return e.cloneNode(!0)}),m=function(e,n){a(n),U(n,function(n){Object.defineProperty(n,i.key,{configurable:!0,enumerable:!1,get:function(){return e}})})}.bind(this,p.length);m(y),G(n(y),r,o,m),d&&t(y,function(e){v.appendChild(e)}),i.m&&t(y,function(e){e instanceof HTMLElement&&i.m(e)}),f.splice.apply(f,[s,0].concat(y)),s+=y.length,p.push(y)}d.insertBefore(v,i.u)}else if(p.length>h)for(;p.length!==h;){var g=p.pop();t(g,function(e){f.splice(f.indexOf(e),1),e.parentNode&&e.parentNode.removeChild(e)}),X(g)}})}function z(e){return function(n){n.stopPropagation(),t(e,function(e){e()})}}function G(o,i,a,u){var c,f=function(e){if(c)throw new Error("Improper usage of key(string).in(array): key(string) cannot be nested on the same level");return c={key:e},f};return f.in=function(e){if(!c)throw new Error("Improper usage of key(string).in(array): key(string) not called");if(c.c)throw new Error("Improper usage of key(string).in(array): in(array) called before key");var n=S(e,I);if(!n||!n instanceof L)throw new Error("Improper usage of key(string).in(array): in(array) is not provided with a proxified object of the same root");c.watcher=n,c.c=e,c.i=[]},f.end=function(e){if(!(c&&c.key&&c.i&&c.i.length))throw new Error("Improper usage of key.end([onClone]): key(string).in(array) is not called properly prior to calling key.end([onClone])");c.t=o,c.u=c.i.pop(),r(e)&&(c.m=e);for(var n=c.i,t=o.length-1;t>=0;t--)if(-1!==n.indexOf(o[t])){var f=o[t].parentNode;f&&f.removeChild(o[t]),o.splice(t,1)}var s=c.n=c.u.previousSibling,l=z([_(i,a,c,u),function(){s.removeEventListener($,l)}]);s.addEventListener($,l),c=void 0},t(n(o),function(n){if(c&&c.i&&c.i.push(n),n instanceof Comment&&"foreach:"===n.textContent.trim().substr(0,8).toLowerCase()){if(K(n,i,a,u),e.call(n,n.textContent,{key:f}),!(!c||c.key&&c.i))throw new Error("Improper usage of key(string).in(array): in(array) not called in conjunction with key");c&&!c.n&&(c.n=n)}}),t(o,function(e){e[a]!==i&&K(e,i,a,u)}),Object.setPrototypeOf(o,q)}function K(r,o,u,f){var d=[];if(Object.defineProperty(r,u,{configurable:!0,get:function(){return o},set:function(e){return a(e)&&l(e,o),o}}),d.push(function(){delete r[u]}),r instanceof CharacterData){var p=R(r,r,u);p&&d.push(p)}else G(n(r.childNodes),o,u,f);t(r.attributes,function(n){var o=R(n,r,u);if(o&&d.push(o),!("name"!==n.name||"INPUT"!==r.nodeName&"TEXTAREA"!==r.nodeName&"SELECT"!==r.nodeName)){var a=function(){try{A=!0;var t=e.call(r,"this."+u+h(n.value)+n.value,{},!0);A=!1,t!==r.value&&(r.value=t)}catch(e){r.value=null,A=!1}},f="value",l=r.type.toLowerCase();"number"===l||"range"===l?(f="valueAsNumber",a=function(){try{A=!0;var t=e.call(r,"this."+u+h(n.value)+n.value,{},!0);A=!1,i(t)&&t!==r.valueAsNumber?r.valueAsNumber=t:t!==r.valueAsNumber&&(r.value=null)}catch(e){r.value=null,A=!1}}):"checkbox"===l?(f="checked",a=function(){try{A=!0;var t=e.call(r,"this."+u+h(n.value)+n.value,{},!0);A=!1,"boolean"==typeof t&&t!==r.checked?r.checked=t:t!==r.checked&&(r.checked=!1)}catch(e){r.checked=!1,A=!1}}):"radio"===l?a=function(){try{A=!0;var t=e.call(r,"this."+u+h(n.value)+n.value,{},!0);A=!1,r.value!==t||r.checked?r.value!==t&&r.checked&&(r.checked=!1):r.checked=!0}catch(e){r.checked=!1,A=!1}}:"date"!==l&&"month"!==l&&"week"!==l&&"time"!==l&&"datetime-local"!==l||(f="valueAsDate",a=function(){try{A=!0;var t=e.call(r,"this."+u+h(n.value)+n.value,{},!0);A=!1,t instanceof Date&&t.getTime()!==r.valueAsDate.getTime()?r.valueAsDate=t:t instanceof Date||(r.value=null)}catch(e){r.value=null,A=!1}}),d.push(J(function(){A=!0,e.call(r,"this."+u+h(n.value)+n.value),A=!1},[{to:"del",fn:a},{to:"set",fn:a}]));var p=["change","keyup","click"],v=function(t){var o=s(c(32,48));e.call(r,"this."+u+h(n.value)+n.value+" = "+o,{[o]:r[f]})};t(p,function(e){r.addEventListener(e,v)}),d.push(function(){t(p,function(e){r.removeEventListener(e,v)})})}}),d.push(function(){r.removeEventListener($,v)});var v=z(d);return r.addEventListener($,v),Object.setPrototypeOf([r],q)}var Q=function(e,t={},r="app"){var i=y(t),u=function e(t,r,i,a=function(){}){if(o(t)){var u=document.createElement("template");return u.innerHTML=t.trim(),e(u.content.childNodes,r,i,a)}return t instanceof NodeList||t instanceof Array&&t.reduce(function(e,n){return e&&n instanceof Node},!0)?G(n(t),r,i,a):t instanceof Node?K(t,r,i,a):void 0}(e,i,r);return Object.defineProperty(u,r,{get:function(){return i},set:function(e){a(e)&&l(e,i)}}),u};d(Q,"convert",y);var V=function(e){var n=e+"Promise";return v[n]?v[n]:v[n]=new Promise(function(n){v[e]=n})},W=function(e,n){var t=e+"Promise";r(n)&&v[t].then(n)};return d(Q,"on",{}),p(Q.on,"asyncend",V.bind(this,"asyncEnd"),W.bind(this,"asyncEnd")),p(Q.on,"renderend",V.bind(this,"renderEnd"),W.bind(this,"renderEnd")),d(Q,"random",{}),d(Q.random,"number",c),d(Q.random,"string",s),Q}(function(s,sv,t=!1){try{if(sv)with(sv)return eval(s);return eval(s)}catch(o3o){if(t)throw o3o;return console.error("failed to evaluate expression ["+s+"]",this,o3o),""}});"undefined"!=typeof module&&(module.exports=proxymity);